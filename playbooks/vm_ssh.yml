- name: Change hostname on a remote host
  hosts: all
  become: true
  gather_facts: false

  vars:
    new_hostname: "new-hostname"

  tasks:
    - name: Check current hostname
      command: hostname
      register: current_hostname

    - name: Display current hostname
      debug:
        msg: "Current hostname is {{ current_hostname.stdout }}"

    - name: Change the hostname
      command: hostnamectl set-hostname "{{ new_hostname }}"
      register: change_hostname_result

    - name: Display hostname change result
      debug:
        var: change_hostname_result
